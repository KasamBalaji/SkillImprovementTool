{% extends "eval/base_type.html" %}
{% block title %}Fill in the Blanks{% endblock %}

{% block page_content %}
<h1>{{task_data["content"]}}</h1>
<br>
<a href='{{task_data["referencelinks"]}}'>{{task_data["referencelinks"]}}</a>
<br>
<input type="text" id="answer">
<a href="#" role="button" id="btnSubmit">Submit</a>
<div id="error"></div>

<!-- Scripts -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    $.extend(
        {
            redirectPost: function(location, args)
            {
                var form = '';
                $.each( args, function( key, value ) {
                    value = value.split('"').join('\"')
                    form += '<input type="hidden" name="'+key+'" value="'+value+'">';
                });
                $('<form action="' + location + '" method="GET">' + form + '</form>').appendTo($(document.body)).submit();
            }
        });
    </script>
<script>
    document.getElementById("btnSubmit").addEventListener("click",function(event){
        event.preventDefault();
        var value =document.getElementById("answer").value;
        if (value==""){document.getElementById("error").innerHTML= "Answer can't be None";   return false; };

   
    var server_data ={answer: value,qno:"{{qno}}",type:"task"};
    console.log(server_data);
        $.ajax({
    type: "POST",
    url: "{{url_for('eval.submit')}}",
    data: JSON.stringify(server_data),
    contentType: "application/json",
    dataType: 'json',
    success: function(result) {
       console.log("Redirected")
    } 
    });
    var redirect = "{{url_for('eval.test')}}";
    $.redirectPost(redirect, {qno:"{{qno}}"});
    return false;
});
</script>

{% endblock %}